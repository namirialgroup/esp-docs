{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"ESP","text":"<p>ESP is an implementation of a Service Provider that wraps the spid-aspnetcore library.</p>"},{"location":"#authentication-methods","title":"Authentication methods","text":"<p>ESP provides to your software the capability to login with the italian SPID, CIE and EIDAS authentication methods.</p>"},{"location":"changelog/","title":"Changelog","text":"<p>All notable changes to this project will be documented in this file.</p>"},{"location":"changelog/#2313-2023-08-28","title":"[23.1.3] - 2023-08-28","text":""},{"location":"changelog/#added","title":"Added","text":"<ul> <li>Added prefix to getTransaction method</li> </ul>"},{"location":"changelog/#2312-2023-07-06","title":"[23.1.2] - 2023-07-06","text":""},{"location":"changelog/#changed","title":"Changed","text":"<ul> <li>Fixed regex</li> </ul>"},{"location":"changelog/#2311-2023-06-27","title":"[23.1.1] - 2023-06-27","text":""},{"location":"changelog/#added_1","title":"Added","text":"<ul> <li>Added reference to db</li> </ul>"},{"location":"changelog/#2310-2023-06-26","title":"[23.1.0] - 2023-06-26","text":""},{"location":"changelog/#added_2","title":"Added","text":"<ul> <li>Reference parameter for spid login</li> <li>April PT Fix</li> </ul>"},{"location":"changelog/#2302-2023-04-21","title":"[23.0.2] - 2023-04-21","text":""},{"location":"changelog/#added_3","title":"Added","text":"<ul> <li>Minori support for Nam.Id</li> </ul>"},{"location":"changelog/#removed","title":"Removed","text":"<ul> <li>Intesa from spid idp list</li> </ul>"},{"location":"changelog/#2301-2023-04-06","title":"[23.0.1] - 2023-04-06","text":""},{"location":"changelog/#changed_1","title":"Changed","text":"<ul> <li>Added support for CIE LVL 1/2</li> </ul>"},{"location":"changelog/#2234-2023-01-10","title":"[22.3.4] - 2023-01-10","text":""},{"location":"changelog/#changed_2","title":"Changed","text":"<ul> <li>Logout bug fixes</li> <li>Demo app fixes</li> <li>Datadog ASM fix</li> </ul>"},{"location":"changelog/#2233-2022-11-30","title":"[22.3.3] - 2022-11-30","text":""},{"location":"changelog/#changed_3","title":"Changed","text":"<ul> <li>Datadog fixes</li> <li>Spid Minori fixes</li> </ul>"},{"location":"changelog/#2232-2022-11-22","title":"[22.3.2] - 2022-11-22","text":""},{"location":"changelog/#changed_4","title":"Changed","text":"<ul> <li>Test fixes</li> <li>Bug fixes</li> </ul>"},{"location":"changelog/#2231-2022-11-08","title":"[22.3.1] - 2022-11-08","text":""},{"location":"changelog/#added_4","title":"Added","text":"<ul> <li>Aggregated/Aggregator feature</li> <li>Download Certs</li> <li>Download Agid Zip</li> <li>User Section</li> </ul>"},{"location":"changelog/#changed_5","title":"Changed","text":"<ul> <li>Refactor Aggregator</li> </ul>"},{"location":"changelog/#removed_1","title":"Removed","text":"<ul> <li>ForceAuthn Internal Service</li> </ul>"},{"location":"changelog/#2230-2022-07-27","title":"[22.3.0] - 2022-07-27","text":""},{"location":"changelog/#added_5","title":"Added","text":"<ul> <li>Api Key Feature</li> </ul>"},{"location":"changelog/#2221-2022-7-22","title":"[22.2.1] - 2022-7-22","text":""},{"location":"changelog/#added_6","title":"Added","text":"<ul> <li>Spid Minori support</li> </ul>"},{"location":"changelog/#2220-2022-6-30","title":"[22.2.0] - 2022-6-30","text":""},{"location":"changelog/#changed_6","title":"Changed","text":"<ul> <li>Bug Fixing</li> </ul>"},{"location":"changelog/#2213-2022-6-6","title":"[22.1.3] - 2022-6-6","text":""},{"location":"changelog/#changed_7","title":"Changed","text":"<ul> <li>Bug Fixing</li> </ul>"},{"location":"changelog/#2212-2022-5-19","title":"[22.1.2] - 2022-5-19","text":""},{"location":"changelog/#changed_8","title":"Changed","text":"<ul> <li>Bug Fixing</li> </ul>"},{"location":"changelog/#2211-2022-5-12","title":"[22.1.1] - 2022-5-12","text":""},{"location":"changelog/#changed_9","title":"Changed","text":"<ul> <li>Bug Fixing</li> </ul>"},{"location":"changelog/#added_7","title":"Added","text":"<ul> <li>Added fiscalcode</li> </ul>"},{"location":"changelog/#removed_2","title":"Removed","text":"<ul> <li>Removed nbf from JWT token</li> </ul>"},{"location":"changelog/#2210-2022-04-26","title":"[22.1.0] - 2022-04-26","text":""},{"location":"changelog/#added_8","title":"Added","text":"<ul> <li>New C# engine</li> <li>DataProtection with Database</li> </ul>"},{"location":"changelog/#changed_10","title":"Changed","text":"<ul> <li>UI full refactoring</li> </ul>"},{"location":"changelog/#removed_3","title":"Removed","text":"<ul> <li>Old php engine</li> </ul>"},{"location":"changelog/#2120-2021-12-24","title":"[21.2.0] - 2021-12-24","text":""},{"location":"changelog/#added_9","title":"Added","text":"<ul> <li>Fixed security problems</li> </ul>"},{"location":"changelog/#2111-2021-08-18","title":"[21.1.1] - 2021-08-18","text":""},{"location":"changelog/#added_10","title":"Added","text":"<ul> <li>Initial release! \ud83c\udf89 \ud83c\udf89</li> </ul>"},{"location":"configuration/","title":"Configuration","text":"<p>In order to use the <code>Esp</code> to provide SPID/CIE capability to your software, you need to perform the following activities:</p>"},{"location":"configuration/#assessment","title":"Assessment","text":"<p>During the assessment phase, all the information and data are collected that must be communicated to AgID (SPID) or Istituto Poligrafico (CIE) via e-mail and entered in the metadata, that is the configuration file for the service. Furthermore, the required security level (L1 - L2 - L3 for SPID OR L3 for CIE) and the set of SPID/CIE/EIDAS attributes required during authentication (BASIC or FULL according to the SPID attributes table or eIDAS Minimum set for CIE).</p>"},{"location":"configuration/#setup-test-environment","title":"Setup Test Environment","text":"<p>Namirial will prepare the test environment and start the verifications based on the data provided and will send to the customer the accesses for the Test environment, together with:</p> <ol> <li> <p>ApiKey (for each aggregate if needed);</p> </li> <li> <p>Dedicated endpoints of the API and for the redirect of the user during the SPID authentication phase (for each aggregate if needed);</p> </li> <li> <p>Test metadata to be published on a URL in https: // relating to the customer domain. This URL will be indicated in the SPID/CIE membership request email to be sent to the SPID/CIE Technical Institute (for each aggregate if needed).</p> </li> </ol> <p>Once the integration phase has been completed and the correct functioning on the customer side has been ascertained, Namirial will take care of communications with SPID/CIE/EIDAS Technical Institute for testing the environment, requesting, on behalf of the customer, to join SPID/CIE/EIDAS as a Service Provider.</p>"},{"location":"configuration/#testing","title":"Testing","text":"<p>SPID/CIE Technical Institute will carry out the tests both on the adherence of the SAML SPID protocol (carried out within ESP), and on the creation of the customer portal that integrates ESP, outside the Namirial perimeter. It will communicate any requests for clarification, discrepancies and so on to the technical reference indicated by Namirial.</p>"},{"location":"configuration/#deploy-in-production-spideidas","title":"Deploy in production SPID/EIDAS","text":"<p>The EIDAS authentication method is currently available only for public administration institute</p> <p>Namirial, for each private and aggregator customer, deals with the generation of the CSR file (Certificate Signing Request), for the purpose of compiling the Registration Request document, since it is necessary to make a request to generate a production Electronic Seal certificate to the AgID to be used in the application. of ESP production. In the PDF Registration Request, it is by Namirial to fill in the fields: As; Type of Certificate; CSR hash described in the AgID procedure to be included in the Registration Request; The Customer must send the AgID a second certified email (on which he will receive more detailed information), with a ZIP file attached;</p> <ul> <li> <p>the PDF of the Registration Request, signed by the legal representative and in PAdES format;</p> </li> <li> <p>the CSR generated by Namirial.</p> </li> </ul> <p>When the certificate is ready, the customer should send it to Namirial. After that Namirial signs the metadata with this certificate and it sends it to Agid.</p>"},{"location":"configuration/#deploy-in-production-cie","title":"Deploy in production CIE","text":"<p>If the tests have been successful, Istituto Poligrafico requests a series of screenshot that certificates the test environment. After that the CIE tech team integrates your informations to the prod CIE identity provider.</p>"},{"location":"configuration/#go-live","title":"Go live!","text":"<p>Service Provider are now live, now your users can authenticate to your application with SPID or CIE.</p>"},{"location":"configuration/#aggregated-section","title":"Aggregated Section","text":"<p>This part is only for Aggregated Environments</p> <p>In order to use the <code>Esp</code> to provide SPID capability to your software,  you need to perform the following activities:</p> <ul> <li>Compile the assessment document provided by Namirial</li> <li>Namirial should create a specific suite for testing purposes (test users and a test enviroment)</li> <li>The customer should perform its testing activities</li> <li>When the previous step is completed the customer must give feedback to Namirial to go in production</li> <li>Namirial prepares the aggregated production enviroment </li> <li>Namirial comunicates to Agid the new Aggregate</li> <li>Agid propagates to all the identity provider the new aggregate metadata</li> </ul>"},{"location":"integrations/getkey/","title":"Get Key","text":"<p>This endpoint return a session key that should be used to start a authentication process with SPID, CIE or EIDAS. The following http GET call must be made to start the authentication round. Since the call is protected, the ssl certificate provided during Assessment must be used.</p> <p>GET (deprecated)sslprotected/environment_name/getKey</p> <p>GET api/secure/environment_name/getKey</p>"},{"location":"integrations/getkey/#parameters","title":"Parameters","text":"Name Description domain_uri The ESP domain uri environment_name The environment path level It's the authentication level (1-2-3) attributes It's the attribute level (Base-Full) spidType It's the spid purpose value (optional -  default is physical person)"},{"location":"integrations/getkey/#nb","title":"N.B.","text":"<p>The spidType parameter is usefull only for SPID AUTHENTICATION</p>"},{"location":"integrations/getkey/#result","title":"Result","text":"<p>The response of the api is a string that must be used in the login at the <code>authnKey</code> parameter.</p>"},{"location":"integrations/login/","title":"Login","text":"<p>The next step is to authenticate with the service you are integrating (SPID/CIE/EIDAS) then you have to build an address formed by different parameters.</p> <p>(Deprecated) GET environment_name/login_file.php</p> <p>GET environment_name/login_method</p>"},{"location":"integrations/login/#parameters","title":"Parameters","text":"Name Description domain_uri The ESP domain uri environment_name The environment path (Deprecated)login_file The login file used for the authentication (like cielogin-spidlogin) login_method The login file used for the authentication (like cielogin-spidlogin) final It's the redirect url called at the end of the authentication process (It should be comunicated during the assessment phase) (Deprecated)level It's the authentication level (1-2-3) (Deprecated)attributes It's the attribute level (Base-Full) authnKey It's the authn key that has been given at the getkey endpoint"},{"location":"integrations/login/#result","title":"Result","text":"<p>The address that is constructed must then be copied and pasted into the address bar of a browser. The page that opens can be - login screen with SPID - login screen with SPID/EIDAS - login screen with CIE</p>"},{"location":"integrations/login/#login-succeded","title":"Login Succeded","text":"<p>After a succeded login the user will be redirected to the final url parameter.  The parameters that will be returned with querystring should be:</p> <ul> <li> <p>a session id and user key parameter, if the configuration has redirect type set to <code>TOKEN</code>. Now you have to call the token API, if you want the JSON Web Token</p> </li> <li> <p>a jwt token parameter, if the configuration has redirect type set to <code>JWT</code>. Now you have the JWT with the user info. You can see an example of this JWT at the token section.</p> </li> </ul>"},{"location":"integrations/logout/","title":"Logout","text":"<p>This page contains the reference for the logout SPID method (NOT NECESSARY FOR SECOND LEVEL AUTHENTICATIONS!)</p> <p>GET environment_name/logout</p>"},{"location":"integrations/logout/#parameters","title":"Parameters","text":"Name Description domain_uri The ESP domain uri environment_name The environment path final It's the redirect url called at the end of the authentication process (It should be comunicated during the assessment phase)"},{"location":"integrations/logout/#result","title":"Result","text":"<p>The address that is constructed must then be copied and pasted into the address bar of a browser. The page that opens can be - logout screen for SPID identity provider</p>"},{"location":"integrations/logout/#logout-succeded","title":"Logout Succeded","text":"<p>After a succeded logout the user will be redirected to the final url parameter.</p>"},{"location":"integrations/token/","title":"Token","text":"<p>Once the authentication with the IDP service is done, ESP takes care of making a redirect to the final_url specified in the login call, with two parameters the key and id that refer to the user's session on ESP. The third method allows receiving a JWT token containing the user's information.</p> <p>GET (deprecated)sslprotected/environment_name/getUser</p> <p>GET api/secure/environment_name/getUser</p>"},{"location":"integrations/token/#parameters","title":"Parameters","text":"Name Description ID The ESP user identifier key The ESP session key <p>The JWT is a signed token that contains the user information. Signed tokens can verify the integrity of the claims contained within it. JSON Web Tokens are a good way of securely transmitting information between parties.  A sample of GET-USER-JWT content is the following:</p> <p>SPID JWT <pre><code>{\n  \"dateOfBirth\": \"1900-11-19\",\n  \"domicileMunicipality\": \"ANCONA\",\n  \"domicileNation\": \"IT\",\n  \"placeOfBirth\": \"A271\",\n  \"expirationDate\": \"2023-09-10\",\n  \"domicileStreetAddress\": \"via sample, 11\",\n  \"familyName\": \"ROSSI\",\n  \"mobilePhone\": \"00393400000000\",\n  \"address\": \"via sample, 11 60120 ANCONA AN\",\n  \"email\": \"m.rossi@email.com\",\n  \"domicilePostalCode\": \"60120\",\n  \"name\": \"MARIO\",\n  \"countyOfBirth\": \"AN\",\n  \"spidCode\": \"NAMI0000000000\",\n  \"gender\": \"M\",\n  \"fiscalNumber\": \"TINIT-RSSMRA00S19A271B\",\n  \"domicileProvince\": \"AN\",\n  \"digitalAddress\": \"\",\n  \"idCard\": \"\",\n  \"level\": null,\n  \"reqId\": \"_e709d704aa3b47eda307203119a987ac\",\n  \"assertionId\": \"_71ce2354dd3222a0db8477dcb1441fec\"\n}\n</code></pre></p> <p>CIE JWT <pre><code>{\n  \"dateOfBirth\": \"1900-11-19\",\n  \"familyName\": \"ROSSI\",\n  \"name\": \"MARIO\",\n  \"fiscalNumber\": \"TINIT-RSSMRA00S19A271B\",\n  \"reqId\": \"_e709d704aa3b47eda307203119a987ac\",\n  \"assertionId\": \"_71ce2354dd3222a0db8477dcb1441fec\"\n}\n</code></pre></p> <p>You can check from the JWT content using the jwt-io-debugger. You can copy and paste the token and you can see its content.</p>"}]}